(()=>{"use strict";document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("popupBtn"),t=document.querySelector(".window_text .text"),n=document.getElementById("button-run"),r=document.getElementById("button-clear");document.querySelector(".header_button:nth-last-child(2)");let a,i=!1;const o=localforage.createInstance({name:"sideBarSticker"});async function c(){try{let e=await o.keys();if(!e.length)return s({error:"No items in the list"});console.log(e);const n=localStorage.getItem("chatId"),r=localStorage.getItem("minProfit"),a=localStorage.getItem("stickerOverpay");let i=document.createElement("div");i.innerHTML="<h2>Working...</h2>",t.appendChild(i);const c=await fetch("/sticker-parser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({skins:e,minProfit:r,stickerOverpay:a,chatId:n})}),l=await c.json();console.log("Response Data:",l),l?.length?(t.innerText="",l.forEach((e=>{e.length&&e.forEach((e=>{const n=document.createElement("div");if(e.wrongName)return n.innerHTML=`<h2>Wrong Name: ${e.wrongName}</h2>\n                            <hr>`,void t.appendChild(n);const r=e.stickers.map((e=>{const t="–ø–æ—Ç–µ—Ä—Ç–∞—è"===e.price?e.price:`¬•${e.price}`;return`<li>${e.name}: ${t}</li>`})).join("");n.innerHTML=`\n                        <h2>New Item Found!</h2>\n                        <p>Name: ${e.name}</p>\n                        <p>Price: ¬•${e.defaultPrice}</p>\n                        <p>Stickers:</p>\n                        <ul>${r}</ul>\n                        <p>Stickers Total Price: ¬•${e.total_sticker_price}</p>\n                        <p>Profit: ${e.roundedProfit}%</p>\n                        <a href="${e.link}" target="_blank"><p>üí∞  BUY  üí∞</p></a>\n                        <hr>\n                        `,t.appendChild(n)}))})),t.innerHTML||(t.innerHTML="No data available")):l?.error?s(l):t.innerText=l?.message?l.message:"No data available"}catch(e){console.error("Error fetching data:",e),t.innerText="Failed to fetch data"}i&&(a=setTimeout(c,1e4))}function s(r){e.style.display="block",e.getElementsByTagName("p")[0].innerText=`${r.error}: ${r.url||""}`,i=!1,clearInterval(a),n.querySelector("span").innerText="Run",n.classList.remove("_active"),n.style.pointerEvents="none",setTimeout((()=>n.style.pointerEvents=""),5e3),t.innerText=""}n.addEventListener("click",(async t=>{if(t.preventDefault(),n.classList.contains("_active"))i=!1,clearInterval(a),n.querySelector("span").innerText="Run",n.classList.remove("_active"),n.style.pointerEvents="none",setTimeout((()=>n.style.pointerEvents=""),3e3);else{if(!document.cookie.includes("steam=true"))return e.style.display="block",void(e.getElementsByTagName("p")[0].innerText="Please, link your Steam account");i||(n.querySelector("span").innerText="Off",n.classList.add("_active"),i=!0,c())}})),r.addEventListener("click",(function(e){e.preventDefault(),t.innerText=""}))}))})();